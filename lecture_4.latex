\documentclass{article}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{blindtext}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage{placeins}
\usepackage{algpseudocode}
\usepackage{algorithm}
\usepackage{booktabs}
\usepackage{float}
\usepackage[bookmarks=true]{hyperref}
\usepackage{bookmark}
\usepackage{bbm}
\usepackage{wrapfig}
\usepackage{tabularx}
\usepackage[autostyle=true]{csquotes}
\graphicspath{ {./images/} }
\usepackage[bottom=0.5cm, right=1.5cm, left=1.5cm, top=1.5cm]{geometry}

\newtheorem{theorem}{Theorem}
\newtheorem{exercise}{Exercise}
\newtheorem{example}{Example}
\newtheorem{definition}{Definition}[section]

\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\Z}{\ensuremath{\mathbb{Z}}}
\newcommand{\p}{\ensuremath{\mathbb{P}}}
\newcommand{\E}{\ensuremath{\mathbb{E}}}
\newcommand{\F}{\ensuremath{\mathcal{F}}}
\newcommand{\1}{\ensuremath{\mathbbm{1}}}
\newcommand{\B}{\ensuremath{\mathbbm{B}}}

\title{Lecture 4}
\author{Gidon Rosalki}
\date{2025-11-9}


\begin{document}
\maketitle

\section{Multiple Access Domains}\label{sec:multiple_access_domains} % (fold)
Consider when there is a single shared broadcast channel, with two or more simultaneous
transmissions by nodes. There is a collision if a node receives two or more signals at the same time. Multiple Access
Protocols (MAPs) are distributed algorithms that determine how nodes share this channel, or in other words, when a node
can transmit. The communication about sharing this channel takes place over the channel itself. \\

\subsection{Broadcast domains}\label{sub:broadcast_domains} % (fold)
\subsubsection{Wired}\label{sec:wired} % (fold)
It used to be that all nodes would be effectively connected to a single wire, potentially indirectly through a
\textit{hub}. We do not especially use this today, since this had all nodes in the same collision domain, and massively
reduced the amount of data able to be transmitted. Today we mainly use a star topology, with an active \textit{switch}
in the centre. Each node runs a separate connection to the switch, massively increasing available bandwidth.
% subsubsection Wired (end)

\subsubsection{Wireless}\label{sec:wireless} % (fold)
Wireless networks suffer from the same problems with collisions, with the additional issues of potentially some nodes
not receiving the messages, due to signal attenuation over distance, or potential geographic features blocking the
signal.
% subsubsection Wireless (end)

\subsection{MAPs}\label{sub:maps} % (fold)
An idea MAP is as follows: \begin{enumerate}
    \item When one node wants to transmit, it can send at rate $R$
    \item When $M$ nodes want to transmit, each can send at an average rate $\displaystyle\frac{R}{M}$
    \item It is fully decentralised, there is no node that coordinates transmissions 
    \item There is no clock / slot synchronisation
    \item It is as simple as possible
\end{enumerate}

There are also \textbf{Random Access Protocols}, where when a node has a packet to send, it transmits at full channel
data rate $R$, with no a priori coordination between the nodes. Two or more transmitting nodes result in collisions.
Therefore, the RAC specifies how to detect collisions, and how to recover from them. Some examples include slotted
ALOHA, and ALOHA. 
% subsection MAPs (end)

\subsubsection{Goodput and throughput}\label{sec:goodput_and_throughput} % (fold)
\begin{definition}[Goodput]
    The proportion of successful slots (as in, in how many there was a transmission, without a collision)
\end{definition}

\begin{definition}[Throughput]
    The proportion of slots in which there was a transmission (not necessarily successful)
\end{definition}
% subsubsection Goodput and throughput (end)

\subsubsection{Slotted ALOHA}\label{sec:slotted_aloha} % (fold)
We assume that all frames are the same size, and that time is transmitted into equal size slots (each slot is the time
to transmit one frame). Nodes start to transmit only at the beginning of the slot, and they are synchronised. If 2 or
more nodes transmit in a slot, all nodes detect the collision. \\ 
They operate as follows: When a node needs to transmit a frame, it transmits it in the next slot. If there is no
collision, great! If there is a collision, then the node retransmits the frame in the next slot with a probability $p$,
repeated until it succeeds.

This comes with the benefits that a single active node can continuously transmit at the full rate of the channel. It is
also highly decentralised, since only the slot times need to be in sync across the nodes. It's also beautifully simple.
\\ 
However, there are inevitably collisions, which result in wasted slots. Additionally, there are often many idle slots,
and nodes may be able to detect a collision in less than a slot time. Finally, how are we meant to synchronise the
clocks?

Suppose that there are $N$ nodes, each with many frames to send, each transmitting in a given slot with probability $p$.
The probability that a given node succeeds in a given slot is \[
    p \left(1 - p\right)^{N - 1}
\]
and the probability that \textit{some} node succeeds is approximately \[
    Np \left(1 - p\right)^{N - 1}
\]
To find the maximum efficiency, we want to find the $p^*$ that maximises $Np \left(1 - p\right)^{N - 1}$. For many
nodes, taking the limit of $Np \left(1 - p\right)^{N - 1}$ as $N \to \infty$ gives a maximum efficiency of
$\displaystyle\frac{1}{e} \approx 0.37$, or the channel only sends useful transmissions 37\% of the time, which is
\textit{not great}.
% subsubsection Slotted ALOHA (end)

\subsubsection{Pure ALOHA}\label{sec:pure_aloha} % (fold)
Pure, or unslotted ALOHA, is simpler, with no synchronisation. Each host behaves as it if it running slotted ALOHA, but
the slots are local to itself, rather than shared over the network. It sends a frame with a probability of $p$, at the
beginning of a slot. This increase the probability of a collision, each frame that is sent at time $t_0$ will collide
with frames sent in slots that start anywhere from $\left(t_0 - 1, t_0 + 1\right)$.

The goodput is given \begin{align*}
    \p \left[\text{success by given node}\right] &= \p \left[\text{node transmits}\right] \cdot \p \left[\text{no other
    node transmits in interacting times}\right] \\ 
                                                 &= \p \left[\text{node transmits}\right] \\ 
                                                 &\cdot \p \left[\text{no other node transmits in } \left(t_0 - 1,
                                                 t_0\right)\right] \\
                                                 &\cdot \p \left[\text{no other node transmits in } \left(t_0, t_0 +
                                                 1\right)\right] \\
                                                 &= p \cdot \left(1 - p\right)^{N - 1} \cdot \left(1 - p\right)^{N - 1} \\ 
                                                 &= p \cdot \left(1 - p\right)^{2 \left(N - 1\right)}
\end{align*}
Choosing the optimal $p$, and $n \to \infty$ results in even \textbf{worse} than slotted ALOHA, with a result of
$\displaystyle\frac{1}{2e} \approx 0.18$.
% subsubsection Pure ALOHA (end)
% subsection Broadcast domains (end)

\subsection{CSMA}\label{sub:csma} % (fold)
Carrier Sense Multiple Access type protocols \textit{listen} before they transmit. If a channel is sensed as idle,
transmit the entire frame, and if it is busy, defer the transmission. This is like hearing someone else is talking, and
waiting for them to finish before you speak. \\ 

\subsubsection{CSMA/CD}\label{sec:csma_cd} % (fold)
Collisions can still occur, the propagation delay means that two nodes may not hear each others transmission. If there
is a collision, then the entire packet transmission time is wasted. It should be noted that distance and propagation
delay both play a significant role in determining collision probability.

So how do we add collision detection? In a wired LAN we measure the signal strength, and compare the strengths of
transmitted vs received signals. This is harder in wireless, since the received signal strength is overwhelmed by local
transmission strength. Should we detect a collision, then the colliding transmissions are aborted, reducing the channel
wastage.

Adding this in, when a host has a packet to transmit, it checks that the line is quiet before transmitting. If it
detects a collision, then it should stop transmitting, wait a random time, and return to the beginning. This together is
called \textbf{CSMA/CD}.

To ensure that a packet is transmitted without a collision, a host must be able to detect a collision \textit{before} it
finishes transmitting a packet. As a result, we can see that for a host to detect a collision before it finishes
transmitting a packet, we require the transport time to be \[
    \text{Transport time} > 2 \cdot \text{ propagation delay}
\]
In other words, there  is a minimum length packet for CSMA/CD networks, and that is at least 2 times the propagation
delay.

Let us consider the goodput. The time is slotted, and all packets are the same length. A time slot is equal to $2 \cdot $ propagation time. In any
given time slot, a host will decide to transmit (or not) with the probability $p$. So:
\[
    \eta = \displaystyle\frac{\text{Time taken to send data}}{\text{Time taken to send data + overhead}}
\]

Therefore, to find the goodput $\alpha \left(p\right)$, we take the probability that exactly one node transmits in a
given slot \begin{align*}
    \alpha \left(p\right) &= \binom{N}{1} p \left(1 - p\right)^{N - 1} \\ 
    \displaystyle\frac{d\alpha}{dp} &= N \left(1 - p\right)^{N - 1} - p N \left(N - 1\right) \left(1 - p\right)^{N - 2} \\
    \implies p = \displaystyle\frac{1}{N} &\implies \alpha_{max} \approx 37\%
\end{align*}
We will define $A$ to be the expected number of time slots \textbf{wasted} before a packet is successfully transmitted.
Consider for example a coin $X$, such that \[
    \p \left[X = H\right] = 0.4 \stackrel{def}{=} a
\]
Therefore, the expected number of coin tosses before the first head is $\displaystyle\frac{1}{0.4} = 2.5$, and therefore
$A = 1.5$ unsuccessful attempts, which would then be followed by one successful one. \\ 
Let us call the minimum length packet TRANSP. So \begin{align*}
    \eta_{CSMA/CD} &= \displaystyle\frac{TRANSP}{TRANSP + \E \left[\text{Number wasted slots per packet}\right]} \\ 
                   &= \displaystyle\frac{TRANSP}{TRANSP + A \left(2 \cdot PROP\right)} \\ 
                   &= \displaystyle\frac{TRANSP}{TRANSP + \left(3 \cdot PROP\right)}
\end{align*}
% subsubsection CSMA/CD (end)

% subsection CSMA (end)
% section Multiple Access Domains (end)

\section{Single (Logical) Link in practice}\label{sec:single_logical_link} % (fold)
\subsection{MAC Addresses}\label{sub:mac_addresses} % (fold)
Devices connected to a LAN have a MAC address, whose function is to get frames from one interface, to another
physically connected interface on the same network. Most LANs use a 48 bit MAC address, burned into the NIC ROM. Despite
this, it is sometimes settable in software. Each adaptor on the LAN has a unique MAC address. Their allocations are
administered by IEEE. Each manufacturer buys a portion of the MAC address space (which ensures uniqueness). Consider a
MAC address like a personal ID number. This uniqueness ensures that we can move network cards between LANs without
issue (not necessarily true for every address type, consider IP which are hierarchical, and thus not portable). 
% subsection MAC Addresses (end)

\subsection{Ethernet}\label{sub:ethernet} % (fold)
Etherenet is the dominant wired LAN technology. It has nice cheap NICs, and is the first widely used LAN technology.
Over the years, new versions have been released to keep up with speed improvements. 

Ethernet is a CSMA/CD algorithm: \begin{enumerate}
    \item NIC receives a datagram from the network layer, and creates a frame 
    \item If the NIC senses that the channel is idle, it starts frame transmission, and if it senses that it is busy,
        then it waits until the channel is idle, and then transmits. 
    \item If the NIC transmits an entire frame without detecting another transmission, then it is done with the frame. 
    \item If the NIC detects another transmission \textit{while} transmitting, then it aborts, and sends the
        \textbf{jam} signal
    \item After aborting, the NIC enters \textbf{exponential backoff}. After the $m$th collision, it chooses $k$ at
        random from $\left\{0, 1, \dots, 2^m - 1\right\}$, and waits $k \cdot 512$ bit times, before returning to step
        2
\end{enumerate} 
% subsection Ethernet (end)
% section Single (Logical) Link (end)




\end{document}
